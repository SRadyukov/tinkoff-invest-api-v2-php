##Условия использования

###Можно ли сделать публичный сервис на основе TINKOFF INVEST API?
Нет, TINKOFF INVEST API предоставляется только клиентам Тинькофф без права на ретрансляцию данных.

###Можно ли вывести в API показатели компаний/прогнозы/доходности и т.д.?
Пока не имеем права выгружать эти данные для автоматизированных систем. Работаем над этим.

###Какие документы регламентируют юридическую сторону работы API?
Сервис предоставляется в соответствии с [пользовательским соглашением](https://www.tinkoff.ru/about/documents/disclosure/).

###Как открыть дополнительные брокерские счета для использования в TINKOFF INVEST API?
Дополнительные счета Тинькофф Инвестиций открываются в мобильном приложении. Сделать это 
через TINKOFF INVEST API нельзя.

###Какая логика работы с мультисчетами?
Каждый новый счет полностью изолирован от остальных - портфолио, операции, лимиты,
гарантийные обеспечения, уровни достаточности средств учитываются по каждому счету
отдельно. Поэтому может быть ситуация, при которой на одном счете средств хватает с
избытком, а на другом при нехватке средств и активной маржинальной торговле может
наступить маржин-колл.

###Поддерживаются ли сейчас мультисчета в TINKOFF INVEST API?
Да, в TINKOFF INVEST API можно работать с несколькими счетами. Все ключевые методы принимают
на вход параметр *account_id* (идентификатор счёта).

##Котировки инструментов

###Что такое шаг цены?

Шаг цены — это минимальное изменение цены определенного инструмента.

**Пример**

Шаг цены для инструмента = `0.1`, а последняя цена = `10.5` — это означает, что заявка может быть выставлена по одной из следующих цен:

* 10.4
* 10.5
* 10.6

Цена `10.55` будет некорректной и заявка не будет выставлена.

```scala
def isValidPrice(price: BigDecimal, increment: BigDecimal): Boolean = {
    price % increment == 0
}

isValidPrice(10.1, 0.1) // true
isValidPrice(10.16, 0.1) // false
```

###Цены облигаций и фьючерсов

Цены облигаций и фьючерсов в TINKOFF INVEST API предоставляются в пунктах. Методика расчёта стоимости
лота в валюте отличается в зависимости от типа биржевого инструмента.

####Перевод цены облигации в валюту

Пункты цены для котировок облигаций представляют собой проценты номинала облигации. Для пересчёта пунктов
в валюту можно воспользоваться формулой:

> **price** / 100 * **nominal**

Где

* **price** — текущая котировка ценной бумаги;

* **nominal** — номинал облигации.

<a name="futures"></a>
####Перевод цены фьючерса в валюту

Стоимость фьючерсов так же предоставляется в пунктах, для пересчёта можно воспользоваться формулой:
> **price** / **min_price_increment** * **min_price_increment_amount**

Где

* **price** — текущая котировка ценной бумаги;

* **min_price_increment** — шаг цены;

* **min_price_increment_amount** — стоимость шага цены.

Так же при работе с фьючерсами важно учитывать размер гарантийного обеспечения. Узнать эти параметры фьючерсов
можно при помощи метода: [getFuturesMargin](/investAPI/instruments#getfuturesmargin). Подробнее про срочный
рынок читайте [тут](https://help.tinkoff.ru/forts/)

###Почему отличаются исторические цены в TINKOFF INVEST API и других источниках?

Исторические данные [Тинькофф Инвестиций](https://www.tinkoff.ru/invest/) могут отличаться от данных,
которые предоставляют другие сервисы. Связано это может быть как с различными источниками первичных данных,
так и с различными алгоритмами их обработки и агрегации.

##Инструменты, идентификаторы и нюансы работы

###Поддерживает ли TINKOFF INVEST API работу с внебиржевыми инструментами

В данный момент TINKOFF INVEST API предполагает работу только с биржевыми инструментами.

###Торговля бумагами Тинькофф через TINKOFF INVEST API

Из-за огромного количества скальперских сделок мы ограничили торговлю БПИФ от УК "Тинькофф Капитал" 
в TINKOFF INVEST API. В данный момент действует ограничение в 100 сделок с этими бумагами в сутки.

###Валюты в TINKOFF INVEST API

Получить список доступных валют можно при помощи метода [getInstruments/currencies](/investAPI/instruments#currencies).

Обратите внимание, что лотность валют ограничена лотностью, которая предоставляет биржа. Например, операции
с Евро и Долларами возможны только на количества кратные 1000.

##Песочница

###Что такое песочница?
Песочница - это эмулятор торгов, в котором можно проверить торговый алгоритм,
не выводя поручения на биржу и не рискуя реальными деньгами. При этом для работы с
песочницей используется реальная биржевая информация. Подробнее о методах песочницы 
и алгоритмах исполнения заявок: [песочница в TINKOFF INVEST API](/investAPI/head-sandbox)


###Как работает исполнение поручений в песочнице?
Для исполнения заявок используются данные по последним сделкам биржи. Подробнее:
[Алгоритм исполнения заявок в песочнице](/investAPI/head-sandbox#orderexecute)

###Как считается средняя цена покупки инструмента в песочнице?
В данный момент средняя цена покупки в песочнице не рассчитывается. Мы работаем над этим.

###Работают ли шорты в текущей песочнице?
В текущей версии песочницы можно эмулировать торговлю в шорт. Однако при этом не производится расчётов
шорта, баланс ценных бумаг в портфеле просто уходит в минус и не влечёт дополнительных расходов. 

###Почему не работает расчёт маржинальных показателей счёта в песочнице?
В данный момент в песочнице не производится расчёт дополнительных показателей счёта, ставок риска и
размер гарантийного обеспечения. Баланс счёта в песочнице может быть отрицательным и это не влечёт 
никаких последствий (блокировка лимитов, маржинколл и т.п.)

###Почему заявка в песочнице не исполняется? 
Для исполнения заявок используются данные по последним сделкам биржи. Подробнее:
[Алгоритм исполнения заявок в песочнице](/investAPI/head-sandbox#orderexecute). Поэтому исполнение
поручений в песочнице напрямую зависит от активности рынка и стоимости актива на этом рынке. 
Лимитная заявка может не исполняться по причине недостижения установленной цены на бирже. Рыночная же
может не исполняться по причине отсутствия сделок с данными инструментов (низкая ликвидность).

###У меня пропал счёт в песочнице, что делать? 
TINKOFF INVEST API не гарантирует долговременного хранения информации о счёте в песочнице. Если ваш
счёт песочницы "пропал", создайте новый и продолжайте свои тесты. 

